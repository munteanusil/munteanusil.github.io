<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Guard Clauses & Assertions Ã®n .NET â€“ pe scurt, cu exemple</title>
  <meta name="description" content="Ce sunt guard clauses È™i assertions Ã®n .NET, cÃ¢nd se folosesc È™i cum lucreazÄƒ Ã®mpreunÄƒ. ExplicaÈ›ii simple + exemple scurte.">
  <link rel="canonical" href="https://munteanusil.github.io/assertions-guards.html"/>

  <!-- stiluri minime compatibile cu pagina principalÄƒ -->
  <style>
    :root{ --bg:#0b0e14; --card:#11151f; --text:#e6e8ed; --muted:#aab1c0; --brand:#7aa2f7; --max:980px; }
    @media (prefers-color-scheme: light){ :root{ --bg:#fff; --card:#f7f8fb; --text:#0f172a; --muted:#475569; --brand:#2457f5; } }
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
    .wrap{max-width:var(--max);margin:0 auto;padding:0 16px}
    header{padding:32px 0 12px;border-bottom:1px solid rgba(255,255,255,.08)}
    .back{font-size:14px;color:var(--muted)}
    h1{font-size:clamp(26px,4.5vw,38px);margin:6px 0}
    .lead{color:var(--muted);margin:6px 0 18px}
    .heroimg{width:100%;border-radius:16px;background:#0c1220;padding:0;display:block;border:1px solid rgba(255,255,255,.08)}
    main{padding:20px 0 60px}
    h2{margin:28px 0 8px;font-size:22px}
    pre{background:var(--card);border:1px solid rgba(255,255,255,.08);padding:12px;border-radius:12px;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Consolas,monospace}
    .tip{background:var(--card);border:1px solid rgba(255,255,255,.08);padding:12px;border-radius:12px;color:var(--muted)}
    footer{border-top:1px solid rgba(255,255,255,.08);color:var(--muted);padding:18px 0;text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <a class="back" href="index.html">â† Ãnapoi la acasÄƒ</a>
      <h1>Guard Clauses & Assertions Ã®n .NET</h1>
      <p class="lead">â€Garda la uÈ™Äƒâ€ + â€alarma din casÄƒâ€. ÃmpreunÄƒ fac codul mai sigur È™i mai uÈ™or de citit.</p>
    
      <img class="heroimg" src="assets/images/assert&clauses.png" alt="Guard vs Assert â€“ ilustraÈ›ie simplÄƒ">
    </div>
  </header>

 <main class="wrap">
  <h2>1) Ce sunt Guard Clauses?</h2>
  <p>
    <strong>Guard Clause</strong> este un pattern care se foloseÈ™te pentru a valida datele de intrare Ã®ntr-o metodÄƒ sau funcÈ›ie.
  </p>
  <p>ğŸ“Œ <em>Ideea:</em> Ã®nainte sÄƒ rulezi logica principalÄƒ, verifici cÄƒ argumentele primite respectÄƒ regulile de business sau constrÃ¢ngerile minime. DacÄƒ nu â†’ opreÈ™ti imediat execuÈ›ia, de obicei printr-o excepÈ›ie.</p>
  <p><strong>Exemplu din viaÈ›a realÄƒ:</strong> la intrarea Ã®ntr-un club, un bodyguard verificÄƒ dacÄƒ ai bilet valid. DacÄƒ nu, te opreÈ™te Ã®nainte sÄƒ intri. Asta face È™i guard clause cu parametrii.</p>
  <ul>
    <li>se pun la Ã®nceputul metodelor (<em>fail-fast</em>);</li>
    <li>protejeazÄƒ aplicaÈ›ia de date invalide sau neaÈ™teptate;</li>
    <li>reduc codul â€nestedâ€ (evitÄƒ <code>if</code>-uri Ã®n cascadÄƒ).</li>
  </ul>

  <pre><code class="lang-csharp">public void RegisterUser(string email, int age)
{
    if (string.IsNullOrWhiteSpace(email))
        throw new ArgumentException("Email obligatoriu.", nameof(email));

    if (age &lt; 13)
        throw new ArgumentOutOfRangeException(nameof(age), "Minim 13 ani.");

    // logica continuÄƒ doar cu date valide
}</code></pre>

  <h2>2) Ce sunt Assertions?</h2>
  <p>
    <strong>Assertion</strong> este un mecanism folosit Ã®n timpul dezvoltÄƒrii È™i testÄƒrii pentru a verifica dacÄƒ presupunerile interne ale programului sunt corecte.
  </p>
  <p>ğŸ“Œ <em>Ideea:</em> â€Eu, ca programator, È™tiu cÄƒ Ã®n acest punct al codului ceva trebuie sÄƒ fie adevÄƒrat. DacÄƒ nu e â†’ am un bug.â€</p>
  <p><strong>Exemplu din viaÈ›a realÄƒ:</strong> Ã®È›i verifici portofelul dupÄƒ ce ai plÄƒtit la casÄƒ. Te aÈ™tepÈ›i sÄƒ mai ai cardul acolo. DacÄƒ nu e â†’ ceva nu a mers bine Ã®n procesul tÄƒu.</p>
  <ul>
    <li>folosite mai ales Ã®n <em>Debug/Testing</em>, nu pentru inputul utilizatorului;</li>
    <li>dacÄƒ picÄƒ, semnaleazÄƒ o problemÄƒ de implementare;</li>
    <li>Ã®n .NET, se folosesc cu <code>Debug.Assert</code>.</li>
  </ul>

  <pre><code class="lang-csharp">using System.Diagnostics;

public Order MapToOrder(OrderDto dto)
{
    Debug.Assert(dto != null, "DTO validat deja la intrare.");

    var order = new Order(dto.Id, dto.CustomerId);
    Debug.Assert(order.Id != Guid.Empty, "Id nu trebuie sÄƒ fie gol.");

    return order;
}</code></pre>


    <h2>3) ÃmpreunÄƒ, Ã®ntr-un API</h2>
    <pre><code class="lang-csharp">[HttpPost("users")]
public IActionResult Post(RegisterUserDto dto)
{
    // Guard: input din exterior
    if (string.IsNullOrWhiteSpace(dto.Email))
        return BadRequest("Email necesar");

    _userService.Register(dto.Email, dto.Age); // aici pot avea Debug.Assert pentru invariante interne
    return Ok();
}</code></pre>

  <h2>4) DiferenÈ›a cheie</h2>
  <ul>
    <li><strong>Guard Clauses:</strong> pentru date din <em>afarÄƒ</em> (utilizator, API, fiÈ™iere, baze de date).</li>
    <li><strong>Assertions:</strong> pentru <em>invariante interne</em> (logica ta trebuie sÄƒ respecte anumite reguli).</li>
  </ul>

  <h2>5) Cum lucreazÄƒ Ã®mpreunÄƒ?</h2>
  <p>Un proiect matur le foloseÈ™te pe amÃ¢ndouÄƒ:</p>
  <ul>
    <li><strong>Guard Clauses</strong> filtreazÄƒ gunoiul din exterior.</li>
    <li><strong>Assertions</strong> confirmÄƒ cÄƒ logica internÄƒ a codului e solidÄƒ.</li>
  </ul>
  <p>ÃmpreunÄƒ oferÄƒ un dublu nivel de protecÈ›ie:</p>
  <ul>
    <li>EvitÄƒ date invalide.</li>
    <li>EvitÄƒ bug-uri ascunse.</li>
  </ul>
    <h2>Regula uÈ™oarÄƒ</h2>
    <ul>
      <li><strong>Input din afarÄƒ</strong> (user, API, fiÈ™iere) â†’ <em>Guard clause</em>.</li>
      <li><strong>Invariante interne</strong> (â€nu ar trebui sÄƒ se Ã®ntÃ¢mpleâ€) â†’ <em>Assertion</em>.</li>
    </ul>

    <h2>GreÈ™eli frecvente</h2>
    <ul>
      <li>Folosirea <em>Assert</em> pentru input de la utilizator (utilizatorul nu vede nimic Ã®n producÈ›ie).</li>
      <li>Mesaje vagi (â€Invalid dataâ€) â€“ spune clar <em>ce</em> e greÈ™it.</li>
      <li>ValidÄƒri duplicate la fiecare strat fÄƒrÄƒ motiv.</li>
    </ul>

    <h2>Resurse utile</h2>
    <ul>
      <li>Microsoft â€“ <code>ArgumentNullException.ThrowIfNull</code></li>
      <li>Microsoft â€“ <code>System.Diagnostics.Debug.Assert</code></li>
      <li>Ardalis.GuardClauses (GitHub)</li>
      <li>OWASP â€“ Input Validation Cheat Sheet</li>
    </ul>
  </main>

  <footer>
    Â© <script>document.write(new Date().getFullYear())</script> Â· Scris de Munteanu Silviu-Cristian
  </footer>
</body>
</html>
