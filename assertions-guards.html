<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Guard Clauses & Assertions Ã®n .NET â€“ pe scurt, cu exemple</title>
  <meta name="description" content="Ce sunt guard clauses È™i assertions Ã®n .NET, cÃ¢nd se folosesc È™i cum lucreazÄƒ Ã®mpreunÄƒ. ExplicaÈ›ii simple + exemple scurte.">
  <link rel="canonical" href="https://munteanusil.github.io/assertions-guards.html"/>

  <!-- stiluri minime compatibile cu pagina principalÄƒ -->
  <style>
    :root{ --bg:#0b0e14; --card:#11151f; --text:#e6e8ed; --muted:#aab1c0; --brand:#7aa2f7; --max:980px; }
    @media (prefers-color-scheme: light){ :root{ --bg:#fff; --card:#f7f8fb; --text:#0f172a; --muted:#475569; --brand:#2457f5; } }
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
    .wrap{max-width:var(--max);margin:0 auto;padding:0 16px}
    header{padding:32px 0 12px;border-bottom:1px solid rgba(255,255,255,.08)}
    .back{font-size:14px;color:var(--muted)}
    h1{font-size:clamp(26px,4.5vw,38px);margin:6px 0}
    .lead{color:var(--muted);margin:6px 0 18px}
    .heroimg{width:100%;border-radius:16px;background:#0c1220;padding:0;display:block;border:1px solid rgba(255,255,255,.08)}
    main{padding:20px 0 60px}
    h2{margin:28px 0 8px;font-size:22px}
    pre{background:var(--card);border:1px solid rgba(255,255,255,.08);padding:12px;border-radius:12px;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Consolas,monospace}
    .tip{background:var(--card);border:1px solid rgba(255,255,255,.08);padding:12px;border-radius:12px;color:var(--muted)}
    footer{border-top:1px solid rgba(255,255,255,.08);color:var(--muted);padding:18px 0;text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <a class="back" href="index.html">â† Ãnapoi la acasÄƒ</a>
      <h1>Guard Clauses & Assertions Ã®n .NET</h1>
      <p class="lead">â€Garda la uÈ™Äƒâ€ + â€alarma din casÄƒâ€. ÃmpreunÄƒ fac codul mai sigur È™i mai uÈ™or de citit.</p>
    
      <img class="heroimg" src="assets/images/assert&clauses.png" alt="Guard vs Assert â€“ ilustraÈ›ie simplÄƒ">
    </div>
  </header>

 <main class="wrap">
  <h2>1) Ce sunt Guard Clauses?</h2>
  <p>
    <strong>Guard Clause</strong> este un pattern care se foloseÈ™te pentru a valida datele de intrare Ã®ntr-o metodÄƒ sau funcÈ›ie.
  </p>
  <p>ğŸ“Œ <em>Ideea:</em> Ã®nainte sÄƒ rulezi logica principalÄƒ, verifici cÄƒ argumentele primite respectÄƒ regulile de business sau constrÃ¢ngerile minime. DacÄƒ nu â†’ opreÈ™ti imediat execuÈ›ia, de obicei printr-o excepÈ›ie.</p>
  <p><strong>Exemplu din viaÈ›a realÄƒ:</strong> la intrarea Ã®ntr-un club, un bodyguard verificÄƒ dacÄƒ ai bilet valid. DacÄƒ nu, te opreÈ™te Ã®nainte sÄƒ intri. Asta face È™i guard clause cu parametrii.</p>
  <ul>
    <li>se pun la Ã®nceputul metodelor (<em>fail-fast</em>);</li>
    <li>protejeazÄƒ aplicaÈ›ia de date invalide sau neaÈ™teptate;</li>
    <li>reduc codul â€nestedâ€ (evitÄƒ <code>if</code>-uri Ã®n cascadÄƒ).</li>
  </ul>

  <pre><code class="lang-csharp">public void RegisterUser(string email, int age)
{
    if (string.IsNullOrWhiteSpace(email))
        throw new ArgumentException("Email obligatoriu.", nameof(email));

    if (age &lt; 13)
        throw new ArgumentOutOfRangeException(nameof(age), "Minim 13 ani.");

    // logica continuÄƒ doar cu date valide
}</code></pre>

<h2>2) Assertion Methods (ca Guard Clauses reutilizabile)</h2>
<p>
  <strong>Assertion Methods</strong> sunt metode statice de validare pe care le scrii o singurÄƒ datÄƒ È™i apoi le foloseÈ™ti ca â€mini-guard clausesâ€ Ã®n toatÄƒ aplicaÈ›ia.
  Sunt parte din <em>Defensive Programming</em>: reduc codul duplicat, menÈ›in regulile consecvente È™i pÄƒstreazÄƒ logica de business curatÄƒ.
</p>

<div class="tip">
  <strong>Pe scurt:</strong> un <em>guard clause</em> extras Ã®ntr-o metodÄƒ reutilizabilÄƒ = <em>assertion method</em>.
</div>

<h3>Exemplu 1 â€” Valoare pozitivÄƒ</h3>
<pre><code class="lang-csharp">// Assertion Method
public static class Ensure
{
    public static void Positive(decimal number, string message, string? paramName = null)
    {
        if (number <= 0) throw new ArgumentException(message, paramName);
    }
}

// Folosire ca Guard Clause
public void CreateInvoice(decimal amount)
{
    Ensure.Positive(amount, "Valoarea facturii trebuie sÄƒ fie > 0.", nameof(amount));
    Console.WriteLine($"FacturÄƒ creatÄƒ cu {amount} lei.");
}
</code></pre>

<h3>Exemplu 2 â€” Email valid (simplu)</h3>
<pre><code class="lang-csharp">public static class Ensure
{
    public static void ValidEmail(string email, string message, string? paramName = null)
    {
        if (string.IsNullOrWhiteSpace(email) || !email.Contains("@"))
            throw new ArgumentException(message, paramName);
    }
}

// Folosire
public void RegisterUser(string email)
{
    Ensure.ValidEmail(email, "Email-ul introdus nu este valid.", nameof(email));
    Console.WriteLine("User Ã®nregistrat cu succes!");
}
</code></pre>

<h3>Exemplu 3 â€” Nu null / nu gol (helper clasic)</h3>
<pre><code class="lang-csharp">public static class Ensure
{
    public static string NotNullOrWhiteSpace(string? value, string message, string? paramName = null)
    {
        if (string.IsNullOrWhiteSpace(value)) throw new ArgumentException(message, paramName);
        return value!;
    }
}

// Folosire + chaining
public void CreateProject(string name, decimal budget)
{
    var safeName = Ensure.NotNullOrWhiteSpace(name, "Numele proiectului este obligatoriu.", nameof(name));
    Ensure.Positive(budget, "Bugetul trebuie sÄƒ fie > 0.", nameof(budget));

    // logica continuÄƒ doar cu date valide
    Console.WriteLine($"Proiect '{safeName}' cu buget {budget} lei.");
}
</code></pre>

<h3>De ce sÄƒ le foloseÈ™ti</h3>
<ul>
  <li><strong>Mai curat:</strong> extragi <code>if</code>-urile repetitive Ã®ntr-un singur loc.</li>
  <li><strong>Reutilizabil:</strong> aceeaÈ™i regulÄƒ se aplicÄƒ Ã®n multe servicii/straturi.</li>
  <li><strong>UÈ™or de schimbat:</strong> dacÄƒ regula evolueazÄƒ (ex. email cu regex), modifici o singurÄƒ metodÄƒ.</li>
  <li><strong>Fail-fast consecvent:</strong> arunci excepÈ›ii clare (ex. <code>ArgumentException</code> / <code>ArgumentOutOfRangeException</code>).</li>
</ul>

<div class="tip">
  <strong>Sfat practic:</strong> pÄƒstreazÄƒ metodele Ã®n clasa staticÄƒ <code>Ensure</code> (sau <code>Guard</code>) dintr-un proiect comun.
  Astfel, toate serviciile folosesc aceleaÈ™i reguli.
</div>

  </main>

  <footer>
    Â© <script>document.write(new Date().getFullYear())</script> Â· Scris de Munteanu Silviu-Cristian
  </footer>
</body>
</html>
